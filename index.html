<html>

<body>
    <h1>Conway's game of life</h1>
    <p>Talk to make life</p>
    <div id="g"></div>
    <style>
        #g {
            display: fixed;
            inset: 0;
            display: grid;
            grid-template-columns: repeat(32, 1fr);
            grid-template-rows: repeat(32, 1fr);
            color: #026;
            background: #026;
            aspect-ratio: 1;
            overflow: hidden;
        }

        @keyframes b {
            from {
                color: #026;
            }

            to {
                color: #3b7;
            }
        }

        @keyframes l {
            from {
                color: #3b7;
            }

            to {
                color: #026;
            }
        }

        @keyframes c {
            0% {
                color: #3b7;
            }

            80% {
                color: #d80;
            }

            100% {
                color: #026;
            }
        }


        #g>* {
            position: relative;
            width: min(4dvw, 4dvh);
            aspect-ratio: 1;
            border: 0;
            color: transparent;
            background: transparent;

            * {
                border-radius: 100%;
                display: block;
                position: absolute;
                top: -25%;
                left: -25%;
                bottom: -25%;
                right: -25%;
                background: transparent radial-gradient(circle at center, currentColor, #0260 65%);
            }

            &.a {
                color: #3b7;
            }

            &.b {
                animation: b 300ms;
            }

            &.l {
                animation: l 300ms;
            }

            &.c {
                animation: c 300ms;
            }
        }
    </style>
    <script>
const width=32,column=e=>32*e||1,d=document,ce=e=>d.createElement(e),ac=(e,t)=>e.appendChild(t),t=setTimeout,g=d.getElementById("g"),cl=e=>e.classList,clear=(e,t)=>cl(e).remove(t),set=(e,n,a)=>{cl(e).add(n),a&&t((()=>clear(e,a)),50)},elements=Array.from({length:32}).map(((e,t)=>Array.from({length:32}).map(((e,t)=>{const n=ce("button");return n.onclick=()=>cl(n).toggle("a"),ac(n,ce("i")),ac(g,n),n})))),is_alive=e=>e&&cl(e).contains("a"),neighbors=(e,t)=>{let n=0;for(let a=e-1;a<e+2;a++)for(let c=t-1;c<t+2;c++)a==e&&c==t||is_alive(elements[a]?.[c])&&n++;return n};let running=!1;navigator.mediaDevices.getUserMedia({audio:!0}).then((e=>{const t=new AudioContext,n=t.createMediaStreamSource(e),c=t.createAnalyser();c.fftSize=2048;const l=c.frequencyBinCount,r=new Uint8Array(l);n.connect(c),running=!0;const s=()=>{requestAnimationFrame(s),c.getByteTimeDomainData(r);for(let e in r){let t=Math.floor(e/32),n=e%32,c=r[e]/2;const l=elements[t][n];c>80?(set(l,"a"),c>90&&set(l,"c","a")):c<40&&clear(a,"a")}};s()}));const step=()=>{for(let e in elements)for(let n in elements[e]){const a=elements[e][n];["b","l","c"].map((e=>clear(a,e)));let c=neighbors(parseInt(e),parseInt(n));const l=is_alive(a);l&&c<2?set(a,"l","a"):l&&c>3?set(a,"c","a"):l||3!=c||(set(a,"b"),t((()=>set(a,"a","b")),250))}};setInterval(step,600);
    </script>
</body>

</html>